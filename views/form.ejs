<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registration Form - MCCC</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    <style>
      body {
        background-color: #f8f9fa;
      }
      /* Navbar Styling */
      .navbar {
        height: 65px;
        background-color: #fff;
        border-bottom: 2px solid #ddd;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .navbar-brand {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 18px;
        font-weight: 600;
        color: #333;
      }
      .navbar-brand img {
        max-height: 40px;
      }
      .container {
        max-width: 600px;
        margin-top: 20px;
      }
      .card {
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .form-label {
        font-weight: 600;
      }
      .required::after {
        content: " *";
        color: red;
        font-weight: bold;
      }
      .btn-primary {
        width: 100%;
        padding: 10px;
        font-size: 16px;
      }
      /* Legal Disclaimer Modal Styling */
      .modal-title {
        text-transform: small-caps;
        font-weight: bold;
      }
      /* Hide the PRS Date field by default */
      #prsDateField {
        display: none;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar">
      <a class="navbar-brand" href="/">
        <img src="/images/mccc-reg-logo.png" alt="MCCC Logo" />
        Magnificat Central Credit Cooperative
      </a>
    </nav>

    <!-- Registration Form -->
    <div class="container">
      <div class="card p-4 mt-4">
        <h2 class="text-center mb-4">Registration Form</h2>

        <form
          id="registrationForm"
          action="/preview"
          method="POST"
          enctype="multipart/form-data"
        >
          <input type="hidden" name="roll_number" value="<%= rollNumber %>" />

          <!-- PRS Question -->
          <div class="mb-3">
            <label class="form-label required"
              >Have you previously completed a Pre-Registration Seminar (PRS) as
              required by CDA?</label
            >
            <div class="form-check">
              <input
                class="form-check-input"
                type="radio"
                name="prs_completed"
                value="Yes"
                required
                onchange="togglePrsDateField()"
              />
              <label class="form-check-label">Yes</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input"
                type="radio"
                name="prs_completed"
                value="No"
                required
                onchange="togglePrsDateField()"
              />
              <label class="form-check-label">No</label>
            </div>
          </div>

          <!-- PRS Date Field (Hidden by Default) -->
          <div class="mb-3" id="prsDateField">
            <label class="form-label required">Approximate Date for PRS</label>
            <input type="date" class="form-control" name="prs_date" />
          </div>

          <!-- Membership Type -->
          <div class="mb-3">
            <label class="form-label required">Membership Type</label>
            <div class="form-check">
              <input
                class="form-check-input required-field"
                type="radio"
                name="membership_type"
                value="Regular"
                required
              />
              <label class="form-check-label">Regular</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input required-field"
                type="radio"
                name="membership_type"
                value="Associate"
                required
              />
              <label class="form-check-label">Associate</label>
            </div>
          </div>

          <!-- Personal Information -->
          <div class="mb-3">
            <label class="form-label required">Family Name</label>
            <input
              type="text"
              class="form-control required-field"
              name="family_name"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label required">First Name:</label>
            <input
              type="text"
              class="form-control required-field"
              name="first_name"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label">Middle Name</label>
            <input type="text" class="form-control" name="middle_name" />
          </div>

          <div class="mb-3">
            <label class="form-label required">Gender</label>
            <div class="form-check">
              <input
                class="form-check-input required-field"
                type="radio"
                name="gender"
                value="Male"
                required
              />
              <label class="form-check-label">Male</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input required-field"
                type="radio"
                name="gender"
                value="Female"
                required
              />
              <label class="form-check-label">Female</label>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label required">Birthday</label>
            <input
              type="date"
              class="form-control required-field"
              name="birthday"
              required
            />
          </div>

          <!-- Civil Status Field -->
          <div class="mb-3">
            <label class="form-label required">Civil Status</label>
            <select
              name="civil_status"
              class="form-select required-field"
              required
            >
              <option value="">Select Civil Status</option>
              <option value="Single">Single</option>
              <option value="Married">Married</option>
              <option value="Widowed">Widowed</option>
              <option value="Separated">Separated</option>
              <option value="Divorced">Divorced</option>
            </select>
          </div>

          <div class="mb-3">
            <label class="form-label required">Mobile Phone</label>
            <input
              type="text"
              class="form-control required-field"
              name="mobile_phone"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label required">Email Address</label>
            <input
              type="email"
              class="form-control required-field"
              name="email_address"
              required
            />
          </div>

          <!-- Address Section -->
          <h4 class="mt-4">Address</h4>
          <div class="mb-3">
            <label class="form-label required">Address</label>
            <input
              type="text"
              class="form-control required-field"
              name="address"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label required">Municipality</label>
            <input
              type="text"
              class="form-control required-field"
              name="municipality"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label">Barangay</label>
            <input type="text" class="form-control" name="baranggay" />
          </div>

          <div class="mb-3">
            <label class="form-label required">Province</label>
            <input
              type="text"
              class="form-control required-field"
              name="province"
              required
            />
          </div>

          <!-- ID Type -->
          <div class="mb-3">
            <label class="form-label required">ID Type</label>
            <select name="id_type" class="form-select required-field" required>
              <option value="">Select ID Type</option>
              <option value="Driver's License">Driver's License</option>
              <option value="Passport">Passport</option>
              <option value="Student ID">Student ID</option>
              <option value="Voter's ID">Voter's ID</option>
              <option value="SSS ID">SSS ID</option>
              <option value="National ID">National ID</option>
              <option value="Other ID">Other ID</option>
            </select>
          </div>

          <!-- File Uploads -->
          <div class="mb-3">
            <label class="form-label required">Selfie</label>
            <input
              type="file"
              class="form-control required-field"
              name="selfie"
              accept="image/*"
              capture="user"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label required">ID Front</label>
            <input
              type="file"
              class="form-control required-field"
              name="id_front"
              accept="image/*"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label required">ID Back</label>
            <input
              type="file"
              class="form-control required-field"
              name="id_back"
              accept="image/*"
              required
            />
          </div>

          <!-- Agree to Terms -->
          <div class="mb-3">
            <label class="form-label required"
              >Agree to
              <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal"
                >Terms</a
              >:</label
            >
            <div class="form-check">
              <input
                class="form-check-input required-field"
                type="radio"
                name="agree_to_terms"
                value="Yes"
                required
                onchange="validateForm()"
              />
              <label class="form-check-label">Yes</label>
            </div>
            <div class="form-check">
              <input
                class="form-check-input required-field"
                type="radio"
                name="agree_to_terms"
                value="No"
                required
                onchange="validateForm()"
              />
              <label class="form-check-label">No</label>
            </div>
          </div>

          <!-- Submit Button -->
          <button type="submit" id="submitBtn" class="btn btn-primary" disabled>
            Preview
          </button>
        </form>
      </div>
    </div>

    <!-- Terms & Conditions Modal -->
    <div
      class="modal fade"
      id="termsModal"
      tabindex="-1"
      aria-labelledby="termsModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="termsModalLabel">Legal Disclaimer</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p><strong>LEGAL DISCLAIMER</strong></p>
            <p>
              By submitting this membership application form, I certify that the
              information provided is true, accurate, and complete to the best
              of my knowledge. I understand that any false or misleading
              statements may result in the rejection of my application or
              termination of my membership.
            </p>
            <p>
              I acknowledge that membership is subject to the approval of
              Magnificat Central Credit Cooperative and that my membership
              status may be reviewed or revoked at the organization's
              discretion, in accordance with its bylaws, rules, and regulations.
            </p>
            <p>
              I agree to comply with all applicable laws of the Republic of the
              Philippines, including but not limited to the Data Privacy Act of
              2012 (R.A. 10173), and consent to the collection, processing, and
              storage of my personal information for membership-related
              purposes. I understand that my personal data will be handled
              securely and will not be shared with third parties without my
              explicit consent, except as required by law.
            </p>
            <p>
              By signing or submitting this form, I confirm that I have read,
              understood, and agreed to the terms and conditions set forth in
              this disclaimer.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal: Warning if "No" is selected -->
    <div
      class="modal fade"
      id="warningModal"
      tabindex="-1"
      aria-labelledby="warningModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-warning">
            <h5 class="modal-title" id="warningModalLabel">
              Submission Not Allowed
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>
              You must agree to the terms and conditions to proceed with the
              registration.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript for Form Validation & PRS Field Handling -->
    <script>
      function validateForm() {
        let fields = document.querySelectorAll(".required-field");
        let submitButton = document.getElementById("submitBtn");
        let isValid = true;
        let agreeToTerms = document.querySelector(
          'input[name="agree_to_terms"]:checked'
        );

        fields.forEach((field) => {
          if (!field.value.trim()) {
            isValid = false;
          }
        });

        if (!agreeToTerms || agreeToTerms.value !== "Yes") {
          isValid = false;
        }

        submitButton.disabled = !isValid;
      }

      function validateBeforeSubmit(event) {
        let agreeToTerms = document.querySelector(
          'input[name="agree_to_terms"]:checked'
        );
        if (!agreeToTerms || agreeToTerms.value !== "Yes") {
          event.preventDefault(); // Stop form submission
          var warningModal = new bootstrap.Modal(
            document.getElementById("warningModal")
          );
          warningModal.show();
          return false;
        }
        return true;
      }

      function togglePrsDateField() {
        let prsCompleted = document.querySelector(
          'input[name="prs_completed"]:checked'
        );
        let prsDateField = document.getElementById("prsDateField");

        if (prsCompleted && prsCompleted.value === "Yes") {
          prsDateField.style.display = "block";
          prsDateField.querySelector("input").setAttribute("required", "true");
        } else {
          prsDateField.style.display = "none";
          prsDateField.querySelector("input").removeAttribute("required");
        }
      }

      document
        .getElementById("registrationForm")
        .addEventListener("submit", validateBeforeSubmit);
      document.querySelectorAll(".required-field").forEach((field) => {
        field.addEventListener("input", validateForm);
        field.addEventListener("change", validateForm);
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
